+++
showonlyimage = false
draft = false
image = "img/18B20.jpg"
date = "2019-03-26"
title = "Temperatursensor DS18B20"
writer = "Martin Strohmayer"
categories = ["Raspberry Pi"]
keywords = ["Temperatursensor", "18B20", "18S20", "1-Wire", "w1"]
weight = 1
+++

Mit dem günstigen Sensor DS18B20 und einem Widerstand kann ganz einfach über einen GPIO Pin die Umgebungstemperatur ausgelesen werden. Dazu wird noch nicht mal eine Library oder ein Programm benötigt. Alles nötige ist im Linux-Kernel integriert.
<!--more-->

## Beschreibung ##

Mit dem 1-Wire Sensor DS18B20 von Dallas oder einen eine kompatiblen Sensor, kann ganz einfach die Umgebungstempertur gemessen werden. Man benötigt lediglich den Sensor einen Pull-up Widerstand und einen Devicetree Eintrag in der Konfigurationsdatei. Dann steht der Temperaturwert über das virtuelle Filesystem zur Verfügung. Eine extra Software oder Library ist nicht nötig.

## Anschluss ##

Der 1-Wire Sensor wird mit 3,3 V versorgt und über den GPIO-Pin 4 erfolgt die standardisierte Kommunikation. Lediglich ein zusätzlichen Pull-up Widerstand mit 4,7 KOhm muss man noch hinzuschalten.

![DS18B20 Schaltplan](../../img/18B20_Schaltplan.png) 

![DS18B20 Steckplatine](../../img/18B20_Steckplatine.png) 


## Konfiguration ##

Es muss lediglich der 1-Wire-Bus über einen Devicetree Eintrag in der Konfigurationsdatei "config.txt" parametriert werden. Daduch werden automatisch beim Starten die entsprechenden Kernel-Module (w1_gpio, w1_therm und wire) geladen. 

```
dtoverlay=w1-gpio,gpioin=4,pullup=on
```

## Zugriff ##

Nach einem Neustart ist bereits alles geladen und der Sensor über das virtuelle Dateisystem auslesbar. Die Identifizierung des Sonsors erfolgt über eine eindeutuge ID-Nummer.

```
ls  /sys/bus/w1/devices/
```

```
28-03089779799c  w1_bus_master1
```

```
cat  /sys/bus/w1/devices/28-03089779799c/w1_slave
```

```
8d 01 55 05 7f a5 a5 66 9c : crc=9c YES
8d 01 55 05 7f a5 a5 66 9c t=24812
```

Der ausgelesene Wert t muss noch durch 1000 dividiert werden um auf °C zu kommen.


